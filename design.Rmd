---
title: "French given names per year per department"
author: "Lucas Mello Schnorr, Jean-Marc Vincent"
date: "October, 2022"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# The problem context
The aim of the activity is to develop a methodology to answer a specific question on a given dataset. 

The dataset is the set of Firstname given in France on a large period of time. 
[https://www.insee.fr/fr/statistiques/2540004](https://www.insee.fr/fr/statistiques/fichier/2540004/dpt2021_csv.zip), we choose this dataset because it is sufficiently large, you can't do the analysis by hand, the structure is simple


You need to use the _tidyverse_ for this analysis. Unzip the file _dpt2020_txt.zip_ (to get the **dpt2020.csv**). Read in R with this code. Note that you might need to install the `readr` package with the appropriate command.

```{r}
library(tidyverse)
```

```{r}
library(DoE.wrapper)
```
```{r}
d5_maximin <- lhs.design( type= "maximin" , nruns= 100 ,nfactors= 2 ,
digits= NULL , seed= 27041 , factor.names=list( size=c(10,100),type=c(0,1) ) )

d5_maximin$order =  as.numeric(rownames(d5_maximin))

ggplot() +               
  geom_point(data = d5_maximin, aes(x=size, y=type, color = order))
```
```{r}
random <- lhs.design( type= "improved" , nruns= 100 ,nfactors= 2 ,
digits= NULL , seed= 27041 , factor.names=list( size=c(10,100),type=c(0,1) ) )

random$order =  as.numeric(rownames(random))

ggplot() +               
  geom_point(data = random, aes(x=size, y=type, color = order))
```


```{r}
lhs_design <- lhs.design( type= "maximin" , nruns= 2000, nfactors= 1 , randomize = TRUE,
digits=0 , seed= 401868 , factor.names=list( size=c(100,1000000)) ) #,type=c(0,2) 
```

```{r}
#library(zoo)
lhs_design
b_lhs_design <- do.call("rbind", replicate(3, lhs_design, simplify = FALSE))#mapply(rep, lhs_design, 3) #sapply(lhs_design, rep.int, times=3)
b_lhs_design
b_lhs_design[,1:3]

```


```{r}
lhs_design$order =  as.numeric(rownames(lhs_design))
lhs_design
```
```{r}
ggplot() +               
  geom_point(data = lhs_design, aes(x=size, y=order, color = order))
```


```{r}
lhs_design %>% group_by(type) %>% count()
```
```{r}
lhs_design$type[lhs_design$type == 1] <- "Parallel"
lhs_design$type[lhs_design$type == 0] <- "Sequential"
lhs_design$type[lhs_design$type == 2] <- "Built-in"
lhs_design
```


```{r}
write.csv(lhs_design,"~/workspace/M2R-ParallelQuicksort/data/experiments/lhs_design.csv", row.names = FALSE)
```


```{r}
file_path = "~/workspace/M2R-ParallelQuicksort/data/experiments/lhs_design.csv"

experiment <- read.csv(file_path)
experiment$type[experiment$type == "Parallel"] <- 1
experiment$type[experiment$type == "Sequential"] <- 0
experiment$type[experiment$type == "Built-in"] <- 2

experiment
```



```{r}
factorial_design <- fac.design(nfactors= 2 , replications = 5, repeat.only=TRUE, blocks = 1, randomize = TRUE, seed= 27041 , factor.names=list( size=seq(100,1000000,), type=seq(0,2) ) )
plot(d5_maximin , select = c( "Size","Type" ), main="LHS design")
```


```{r}
d5_maximin
```
```{r}

```



```{r}
d5_maximin <- lhs.design( type= "maximin" , nruns= 100 ,nfactors= 2 ,
digits= c(10,0) , seed= 27041 , factor.names=list( A=c(10,100),B=c(0,1) ) )
plot(d5_maximin , select = c( "A","B" ), main="LHS design")
```
```{r}
d5_maximin
```


